{"version":3,"file":"index.js","sources":["../src/index.js"],"sourcesContent":["import Vir from 'vir'\n\nexport default function (options = {}) {\n  let {\n    waterfall = false,\n      threshold = 200,\n      buttonSelector = '.more'\n  } = options\n  return Vir({\n    data: {\n      data: [],\n      lock: false,\n      state: 'pending'\n    },\n    events: {\n      ['click->' + buttonSelector + '']: 'load'\n    },\n    watch: {\n      data(result) {\n        this.render(result.value)\n      }\n    },\n    methods: {\n      load() {\n        if (this.get('lock')) {\n          return\n        }\n        this.set({\n          'state': 'loading',\n          'lock': true\n        })\n        this.fetch((state = 'done') => {\n          this.set({\n            'state': state,\n            'lock': false\n          })\n        })\n      },\n      fetch(done) {},\n      render(data) {}\n    },\n    init() {\n      if (!waterfall) {\n        return\n      }\n\n      const $window = $(window)\n      $window.on('scroll resize', () => {\n        if (this.get('lock')) {\n          return\n        }\n        if ($(document).height() - $window.scrollTop() - $window.height() < threshold) {\n          this.load()\n        }\n      })\n    }\n  })\n}"],"names":["options","waterfall","threshold","buttonSelector","Vir","result","render","value","get","set","fetch","state","done","data","$window","$","window","on","document","height","scrollTop","load"],"mappings":";;;;;;;;;;;;;;;AAEA,YAAe,YAAwB;;;MAAdA,OAAc,uEAAJ,EAAI;2BAKjCA,OALiC,CAEnCC,SAFmC;MAEnCA,SAFmC,sCAEvB,KAFuB;2BAKjCD,OALiC,CAGjCE,SAHiC;MAGjCA,SAHiC,sCAGrB,GAHqB;8BAKjCF,OALiC,CAIjCG,cAJiC;MAIjCA,cAJiC,yCAIhB,OAJgB;;SAM9BC,IAAI;UACH;YACE,EADF;YAEE,KAFF;aAGG;KAJA;mCAON,YAAYD,cAAZ,GAA6B,EADhC,IACqC,MADrC,UANS;WASF;UAAA,gBACAE,MADA,EACQ;aACNC,MAAL,CAAYD,OAAOE,KAAnB;;KAXK;aAcA;UAAA,kBACA;;;YACD,KAAKC,GAAL,CAAS,MAAT,CAAJ,EAAsB;;;aAGjBC,GAAL,CAAS;mBACE,SADF;kBAEC;SAFV;aAIKC,KAAL,CAAW,YAAoB;cAAnBC,KAAmB,uEAAX,MAAW;;gBACxBF,GAAL,CAAS;qBACEE,KADF;oBAEC;WAFV;SADF;OATK;WAAA,iBAgBDC,IAhBC,EAgBK,EAhBL;YAAA,kBAiBAC,IAjBA,EAiBM;KA/BN;QAAA,kBAiCF;;;UACD,CAACZ,SAAL,EAAgB;;;;UAIVa,UAAUC,EAAEC,MAAF,CAAhB;cACQC,EAAR,CAAW,eAAX,EAA4B,YAAM;YAC5B,OAAKT,GAAL,CAAS,MAAT,CAAJ,EAAsB;;;YAGlBO,EAAEG,QAAF,EAAYC,MAAZ,KAAuBL,QAAQM,SAAR,EAAvB,GAA6CN,QAAQK,MAAR,EAA7C,GAAgEjB,SAApE,EAA+E;iBACxEmB,IAAL;;OALJ;;GAvCG,CAAP;;;;;"}